"use strict";(self.webpackChunkwebxr_threejs=self.webpackChunkwebxr_threejs||[]).push([[416],{416:(e,t,n)=>{n.r(t),n.d(t,{MainScreen:()=>x,default:()=>w});var o=n(75),i=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};let s=!1;const r=e=>i(void 0,void 0,void 0,(function*(){let t=null;const n=document.createElement("button");n.style.display="",n.style.cursor="pointer",n.style.left="calc(50% - 50px)",n.style.width="100px",n.textContent="ENTER VR";const o=()=>{n.style.display="",n.style.cursor="auto",n.style.left="calc(50% - 75px)",n.style.width="150px",n.onmouseenter=null,n.onmouseleave=null,n.onclick=null},r=e=>{e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none"};if(navigator.xr){n.id="VRButton",r(n);try{const r=yield navigator.xr.isSessionSupported("immersive-vr");r?(()=>{const o=()=>{t.removeEventListener("end",o),n.textContent="ENTER VR",t=null};n.onmouseleave=()=>{n.style.opacity="0.5"},n.onmouseenter=()=>{n.style.opacity="1.0"},n.onclick=()=>i(void 0,void 0,void 0,(function*(){if(null===t&&navigator.xr){const r={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};try{s=yield navigator.xr.requestSession("immersive-vr",r),i(void 0,void 0,void 0,(function*(){s.addEventListener("end",o),yield e.xr.setSession(s),n.textContent="EXIT VR",t=s}))}catch(e){console.log(e)}}else t.end();var s}))})():(o(),n.textContent="VR NOT SUPPORTED"),r&&s&&n.click()}catch(e){l=e,o(),console.warn("Exception when trying to call xr.isSessionSupported",l),n.textContent="VR NOT ALLOWED"}return n}{const e=document.createElement("a");return!1===window.isSecureContext?(e.href=document.location.href.replace(/^http:/,"https:"),e.innerHTML="WEBXR NEEDS HTTPS"):(e.href="https://immersiveweb.dev/",e.innerHTML="WEBXR NOT AVAILABLE"),e.style.left="calc(50% - 90px)",e.style.width="180px",e.style.textDecoration="none",r(e),e}var l}));(()=>{if(navigator.xr){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",(()=>{s=!0}))}})();var l=n(579),c=n(12),d=n(418);const a=document.getElementById("renderCanvas");let u=document.getElementById("loadingDiv"),y="0%",m="";var p=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};const v={models:{}};let f=["snowScene.glb"];const h=new o.lLk,g=(e,t)=>p(void 0,void 0,void 0,(function*(){return new Promise((n=>{e.load(`models/${t}`,(e=>{n(e)}))}))}));class x{constructor(){this.createScene=e=>{return t=this,n=void 0,s=function*(){const t=new o.anP(e);(new l.x).load("assets/textures/snowy_park.hdr",(e=>{const o=t.fromEquirectangular(e);n.background=o.texture,n.environment=o.texture}));const n=new o.xsS,i=new o.cPb(60,window.innerWidth/window.innerHeight,.1,100);i.position.set(0,1.6,3),n.add(new o.vmT(6316128,4210752));const s=new o.Ox3(16777215);s.position.set(1,1,1).normalize(),n.add(s),e.xr.enabled=!0;const x=new c.z(i,e.domElement);x.minDistance=2,x.maxDistance=10,x.target.set(0,2,0),x.update();const w=(()=>{if(u)return u;u=document.createElement("div"),u.id="loadingDiv",u.style.height="100vh",u.style.width="100%",u.style.pointerEvents="none",u.style.opacity="1",u.style.backgroundColor="black",u.style.zIndex="-1",u.style.transition="opacity 1.5s ease";const e=document.createElement("div");e.style.display="flex",e.style.alignItems="center",e.style.justifyItems="center",e.style.justifyContent="center",e.style.minHeight="100%",e.style.textAlign="center";const t=document.createElement("div"),n=document.createElement("div");n.style.color="rgba(66, 135, 245, 1)",n.style.textAlign="center";const o=document.createElement("h3");o.innerHTML="Please hang tight..",o.style.fontSize="1.125rem",o.style.lineHeight="1.5rem",o.style.fontWeight="500",n.appendChild(o);const i=document.createElement("p");i.id="loadingText",i.innerHTML="";const s=document.createElement("div");s.style.width="100%",s.style.backgroundColor="gray",s.style.borderRadius="9999px",s.style.height="0.625rem";const r=document.createElement("div");return r.style.width=y,r.style.backgroundColor="blue",r.style.height="0.625rem",r.style.borderRadius="9999px",r.id="progressLevel",s.appendChild(r),n.appendChild(s),t.appendChild(n),e.appendChild(t),n.appendChild(i),u.appendChild(e),(()=>{const e=a.getBoundingClientRect(),t=window.getComputedStyle(a).position,n=document.getElementById("loadingDiv");n&&(n.style.position="fixed"===t?"fixed":"absolute",n.style.left=e.left+"px",n.style.top=e.top+"px",n.style.width=e.width+"px",n.style.height=e.height+"px")})(),document.body.insertBefore(u,a),u})(),E=(yield new Promise(((e,t)=>p(void 0,void 0,void 0,(function*(){h.onProgress=(e,t,n)=>{(e=>{const t=document.getElementById("progressLevel");y=e,t&&(t.style.width=y)})(`${Number(t/n*100).toFixed(0)}%`),(e=>{const t=document.getElementById("loadingText");m=e,t&&(t.innerHTML=m)})(`Loaded ${t} of ${n} files.`)},h.onError=e=>{t("There was an error loading "+e)};const n=new d.E(h).setPath("assets/");for(const e of f)try{const t=yield g(n,e);v.models[e]=t}catch(e){console.log("Error loading model: ",e),t(e)}e(v)}))))).models["snowScene.glb"];let b;n.add(E.scene);const C=yield E.parser.getDependencies("material");for(const e of C)"Snow"===e.name&&(b=e);if(b){const e=new o._12(100,100,20,20),t=new o.Kj0(e,b);t.rotation.x=-Math.PI/2,n.add(t)}const S=yield r(e);return document.body.insertBefore(S,w),(()=>{const e=document.getElementById("loadingDiv");e&&(e.style.opacity="0",e.addEventListener("transitionend",(()=>{e&&e.remove()})))})(),{scene:n,camera:i,update:()=>{}}},new((i=void 0)||(i=Promise))((function(e,o){function r(e){try{c(s.next(e))}catch(e){o(e)}}function l(e){try{c(s.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,l)}c((s=s.apply(t,n||[])).next())}));var t,n,i,s}}}const w=new x}}]);
//# sourceMappingURL=416.threejsBundle.js.map