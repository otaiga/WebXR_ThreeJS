"use strict";(self.webpackChunkwebxr_threejs=self.webpackChunkwebxr_threejs||[]).push([[933],{933:(e,t,n)=>{n.r(t),n.d(t,{MainScreen:()=>x,default:()=>w});var o=n(75),s=n(579),i=n(12),r=n(418);const l=document.getElementById("renderCanvas");let c=document.getElementById("loadingDiv"),d="0%",a="";var u=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};const y={models:{}};let m=["snowScene.glb"];const p=new o.lLk,f=(e,t)=>u(void 0,void 0,void 0,(function*(){return new Promise((n=>{e.load(`models/${t}`,(e=>{n(e)}))}))}));var h=n(922),v=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};const g=e=>v(void 0,void 0,void 0,(function*(){let t=!1;(()=>{if(navigator.xr){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",(()=>{t=!0}))}})();let n=null;const o=document.createElement("button");o.style.display="",o.style.cursor="pointer",o.style.left="calc(50% - 50px)",o.style.width="100px",o.textContent="ENTER VR";const s=()=>{o.style.display="",o.style.cursor="auto",o.style.left="0",o.style.width="100%",o.style.background="red",o.onmouseenter=null,o.onmouseleave=null,o.onclick=null},i=e=>{e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none"};if(navigator.xr){o.id="VRButton",i(o);try{const i=yield navigator.xr.isSessionSupported("immersive-vr");i?(()=>{const t=()=>{n.removeEventListener("end",t),o.textContent="ENTER VR",n=null};o.onmouseleave=()=>{o.style.opacity="0.5"},o.onmouseenter=()=>{o.style.opacity="1.0"},o.onclick=()=>v(void 0,void 0,void 0,(function*(){if(null===n&&navigator.xr){const i={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};try{s=yield navigator.xr.requestSession("immersive-vr",i),v(void 0,void 0,void 0,(function*(){s.addEventListener("end",t),yield e.xr.setSession(s),o.textContent="EXIT VR",n=s}))}catch(e){console.log(e)}}else n.end();var s}))})():(s(),o.textContent="VR NOT SUPPORTED"),i&&t&&o.click()}catch(e){r=e,s(),console.warn("Exception when trying to call xr.isSessionSupported",r),o.textContent="VR NOT ALLOWED"}return o}{const e=document.createElement("a");return!1===window.isSecureContext?(e.href=document.location.href.replace(/^http:/,"https:"),e.innerHTML="WEBXR NEEDS HTTPS"):(e.href="https://immersiveweb.dev/",e.innerHTML="WEBXR NOT AVAILABLE"),e.style.left="calc(50% - 90px)",e.style.width="180px",e.style.textDecoration="none",i(e),e}var r}));class x{constructor(){this.createScene=e=>{return t=this,n=void 0,x=function*(){const t=new o.anP(e);(new s.x).load("assets/textures/snowy_park.hdr",(e=>{const o=t.fromEquirectangular(e);n.background=o.texture,n.environment=o.texture}));const n=new o.xsS,v=new o.cPb(60,window.innerWidth/window.innerHeight,.1,100);v.position.set(0,1.6,3),n.add(new o.vmT(6316128,4210752));const x=new o.Ox3(16777215);x.position.set(1,1,1).normalize(),n.add(x),e.xr.enabled=!0;const w=new i.z(v,e.domElement);w.minDistance=2,w.maxDistance=10,w.target.set(0,2,0),w.update();const E=(()=>{if(c)return c;c=document.createElement("div"),c.id="loadingDiv",c.style.height="100vh",c.style.width="100%",c.style.pointerEvents="none",c.style.opacity="1",c.style.backgroundColor="black",c.style.zIndex="-1",c.style.transition="opacity 1.5s ease";const e=document.createElement("div");e.style.display="flex",e.style.alignItems="center",e.style.justifyItems="center",e.style.justifyContent="center",e.style.minHeight="100%",e.style.textAlign="center";const t=document.createElement("div"),n=document.createElement("div");n.style.color="rgba(66, 135, 245, 1)",n.style.textAlign="center";const o=document.createElement("h3");o.innerHTML="Please hang tight..",o.style.fontSize="1.125rem",o.style.lineHeight="1.5rem",o.style.fontWeight="500",n.appendChild(o);const s=document.createElement("p");s.id="loadingText",s.innerHTML="";const i=document.createElement("div");i.style.width="100%",i.style.backgroundColor="gray",i.style.borderRadius="9999px",i.style.height="0.625rem";const r=document.createElement("div");return r.style.width=d,r.style.backgroundColor="blue",r.style.height="0.625rem",r.style.borderRadius="9999px",r.id="progressLevel",i.appendChild(r),n.appendChild(i),t.appendChild(n),e.appendChild(t),n.appendChild(s),c.appendChild(e),(()=>{const e=l.getBoundingClientRect(),t=window.getComputedStyle(l).position,n=document.getElementById("loadingDiv");n&&(n.style.position="fixed"===t?"fixed":"absolute",n.style.left=e.left+"px",n.style.top=e.top+"px",n.style.width=e.width+"px",n.style.height=e.height+"px")})(),document.body.insertBefore(c,l),c})(),b=(yield new Promise(((e,t)=>u(void 0,void 0,void 0,(function*(){p.onProgress=(e,t,n)=>{(e=>{const t=document.getElementById("progressLevel");d=e,t&&(t.style.width=d)})(`${Number(t/n*100).toFixed(0)}%`),(e=>{const t=document.getElementById("loadingText");a=e,t&&(t.innerHTML=a)})(`Loaded ${t} of ${n} files.`)},p.onError=e=>{t("There was an error loading "+e)};const n=new r.E(p).setPath("assets/");for(const e of m)try{const t=yield f(n,e);y.models[e]=t}catch(e){console.log("Error loading model: ",e),t(e)}e(y)}))))).models["snowScene.glb"];let C;n.add(b.scene);const P=yield b.parser.getDependencies("material");for(const e of P)"Snow"===e.name&&(C=e);if(C){const e=new o._12(100,100,20,20),t=new o.Kj0(e,C);t.rotation.x=-Math.PI/2,n.add(t)}((e,t)=>{const n=new h.i,s=(new o.u9r).setFromPoints([new o.Pa4(0,0,0),new o.Pa4(0,0,-1)]),i=new o.x12(s);i.name="line",i.scale.z=10;const r=[];for(let o=0;o<=1;o++){const s=e.xr.getController(o);s.add(i.clone()),s.userData.selectPressed=!1,t.add(s),r.push(s);const l=e.xr.getControllerGrip(o);l.add(n.createControllerModel(l)),t.add(l)}})(e,n);const S=yield g(e);return document.body.insertBefore(S,E),(()=>{const e=document.getElementById("loadingDiv");e&&(e.style.opacity="0",e.addEventListener("transitionend",(()=>{e&&e.remove()})))})(),{scene:n,camera:v,update:()=>{}}},new((v=void 0)||(v=Promise))((function(e,o){function s(e){try{r(x.next(e))}catch(e){o(e)}}function i(e){try{r(x.throw(e))}catch(e){o(e)}}function r(t){var n;t.done?e(t.value):(n=t.value,n instanceof v?n:new v((function(e){e(n)}))).then(s,i)}r((x=x.apply(t,n||[])).next())}));var t,n,v,x}}}const w=new x}}]);
//# sourceMappingURL=933.threejsBundle.js.map